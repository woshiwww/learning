## 并行硬件和并行软件

**并行硬件和并行软件**是由串行硬件和软件发展而来。

### 冯·诺依曼结构

冯·诺伊曼结构主要由四部分组成：中央处理器(控制单元和算术逻辑单元)、外存、内存和CPU之间的互连结构。

冯·诺伊曼机器一次执行一条指令，一条指令对一个数据进行操作。

![image-20220425191345642](https://tbwan.oss-cn-chengdu.aliyuncs.com/imgs/%E5%B9%B6%E8%A1%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%AF%BC%E8%AE%BA/202204251913746.png)

数据由内存-->CPU，称为读出或取出。CPU-->内存，称为写入或存入到内存。

### 进程、线程、多任务

进程：运行一个程序时，操作系统就会创建一个进程。

多任务：操作系统在一个时间段内能够运行多个程序，每个程序运行完一个时间片后会切换到别的程序。

线程：一个进程包含多个线程，属于同一个进程的线程共享代码、数据和相同的I/O设备。每个线程有自己的栈和程序计数器，使它们可以独立的运行。

### 写直达、写回

写直达：数据立刻写入

写回：数据不立即写回，而是设置一个脏位来判断数据。脏位有效时，写入，无效时，直接丢弃。

### 并行软件

 对于共享内存的系统，正在执行的任务一般指线程。

对于分布式内存的系统，正在执行的任务一般指进程。

### 加速比

S = T串/(T并 + T开销)

### 串行程序并行化

在已经拥有一个串行程序的情况下，先将工作进行拆分，让其分布在各个进程/线程中，使每个进程或线程获得的工作量大致相同，并使通信量最小。

并行化步骤：

1. 划分。将要执行的指令和数据按照计算部分拆分成多个小任务。这一步的关键在于可以识别出可以并行执行的任务。
2. 通信。确定上一步所识别出来的任务之间需要执行哪些通信。
3. 凝聚或聚合。将第一步所确定的任务与通信结合成更大的任务。比如，任务A必须在任务B之前执行，那么可以将他俩聚合成一个复合的任务。
4. 分配。将上一步聚合好的任务分配到进程/线程中。这一步还要使通信量最小化，使各个进程/线程所得到的工作量大致均衡。